syntax = "proto3";

package common.v1;

option go_package = "github.com/dmehra2102/gologistics/gen/go/common/v1;commonv1";

// ErrorCode represents standardized error codes across all services
enum ErrorCode {
    ERROR_CODE_UNSPECIFIED = 0;
    ERROR_CODE_INVALID_ARGUMENT = 1;
    ERROR_CODE_NOT_FOUND = 2;
    ERROR_CODE_ALREADY_EXISTS = 3;
    ERROR_CODE_PERMISSION_DENINED = 4;
    ERROR_CODE_UNAUTHENTICATED = 5;
    ERROR_CODE_RESOURCE_EXHAUSTED = 6;
    ERROR_CODE_FAILED_PRECONDITION = 7;
    ERROR_CODE_ABORTED = 8;
    ERROR_CODE_OUT_OF_RANGE = 9;
    ERROR_CODE_UNIMPLEMENTED = 10;
    ERROR_CODE_INTERNAL = 11;
    ERROR_CODE_UNAVAILABLE = 12;
    ERROR_CODE_DATA_LOSS = 13;
    ERROR_CODE_DEADLINE_EXCEEDED = 14;
}

// ErrorDetail provides structured error information
message ErrorDetail {
    ErrorCode code = 1;
    string message = 2;

    // Field that caused the error
    string field = 3;

    map<string, string> metadata = 4;

    RetryInfo retry_info = 5;
}

// RetryInfo indicates whether the client should retry
message RetryInfo {
    bool retryable = 1;

    // Suggested delay before retry in milliseconds
    int64 retry_delay_ms = 2;
}

// ValidationError represents field-level validation failures
message ValidationError {
    string field = 1;
    string rule = 2;
    string message = 3;
    string rejected_value = 4;
}

// ErrorResponse wraps multiple errors for batch operations
message ErrorResponse {
    // List of errors
    repeated ErrorDetail errors = 1;

    // List of Validation errors
    repeated ValidationError validation_errors = 2;

    // request ID for tracing
    string request_id = 3;

    // Timestamp when error occured
    string timestamp = 4;
}